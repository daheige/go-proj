#!/usr/bin/env bash
#生成上线自动版本号
root_dir=$(cd "$(dirname "$0")"; cd ..; pwd)

mkdir -p $root_dir/HealthCheck/ginCheck

versionFile=$root_dir/HealthCheck/ginCheck/checkversion.go

echo -n ""> $versionFile

version=`date  +"%Y-%m-%d %H:%M"`
echo '
//please do not edit this file,it is auto created by go generate
package ginCheck

import (
	"github.com/gin-gonic/gin"
)

// gin框架健康检查
func HealthCheck(ctx *gin.Context) {
	ctx.JSON(200, map[string]interface{}{
		"code":    0,
		"alive":  true,
		"version": "'${version}'",
	})
}' > $versionFile

go fmt $versionFile

echo "生成checkVersion.go成功"
exit 0
